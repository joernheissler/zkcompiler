G = Z ( -1461501637330902918203684832716283019655932542976,
         1461501637330902918203684832716283019655932542976 );
Gx42 = (G, G, G,  G, G, G,  G,
        G, G, G,  G, G, G,  G,
        G, G, G,  G, G, G,  G,
        G, G, G,  G, G, G,  G,
        G, G, G,  G, G, G,  G,
        G, G, G,  G, G, G,  G);

Gx9 = (G, G, G,  G, G, G,  G, G, G); /* w,~w1,~w2,  ~w3,~w4,^w1,  ^w2,^w3,^w4 */

H = Z_mul_n ( 2835709, qr );
Hx27 = (H, H, H,  H, H, H,  H, H, H,
        H, H, H,  H, H, H,  H, H, H,
        H, H, H,  H, H, H,  H, H, H);

G: a = 1000, b = 99999;
H: e = 1434019, f = 1321157, g = 2128741, h = 797470, gi;

Gx42: w;    /*  w, p,
                ~w1 , ~w2 , ~w3 , ~w4
                ~w1², ~w2², ~w3², ~w4²
                ^w1 , ^w2 , ^w3 , ^w4
                ^w1², ^w2², ^w3², ^w4²

                ~p1 , ~p2 , ~p3 , ~p4
                ~p1², ~p2², ~p3², ~p4²
                ^p1 , ^p2 , ^p3 , ^p4
                ^p1², ^p2², ^p3², ^p4²

                ~p1*, ~p2*. ~p3*, ~p4*
                ^p1*, ^p2*. ^p3*, ^p4*
            */
Hx27: x;    /*  x, ~x, ^x,

                ~x1 , ~x2 , ~x3 , ~x4
                ~x1², ~x2², ~x3², ~x4²
                ^x1 , ^x2 , ^x3 , ^x4
                ^x1², ^x2², ^x3², ^x4²

                ~x1², ~x2², ~x3², ~x4²  with x base
                ^x1², ^x2², ^x3², ^x4²  with x base
            */

phi_H_inverse [ H -> H ] = $ ^ -1;


phi_W [ Gx9 -> Gx42 ] = [?G, ?G, ?G, ?G,
                         ?G, ?G, ?G, ?G,
                         ?G, ?G, ?G, ?G,
                         ?G, ?G, ?G, ?G]

                       :[$.0, ?G,

                         $.1      , $.2      , $.3      , $.4      ,
                         $.1 ^ $.1, $.2 ^ $.2, $.3 ^ $.3, $.4 ^ $.4,
                         $.5      , $.6      , $.7      , $.8      ,
                         $.5 ^ $.5, $.6 ^ $.6, $.7 ^ $.7, $.8 ^ $.8,

                         #. 0, #. 1, #. 2, #. 3,
                         #. 4, #. 5, #. 6, #. 7,
                         #. 8, #. 9, #.10, #.11,
                         #.12, #.13, #.14, #.15,

                         [#. 0 ^ $. 1, #. 4] : #.1 - #.0,
                         [#. 1 ^ $. 2, #. 5] : #.1 - #.0,
                         [#. 2 ^ $. 3, #. 6] : #.1 - #.0,
                         [#. 3 ^ $. 4, #. 7] : #.1 - #.0,

                         [#. 8 ^ $. 5, #.12] : #.1 - #.0,
                         [#. 9 ^ $. 6, #.13] : #.1 - #.0,
                         [#.10 ^ $. 7, #.14] : #.1 - #.0,
                         [#.11 ^ $. 8, #.15] : #.1 - #.0];

phi_W_X [ Gx42 -> Hx27 ] = [ g ^ $.0, h ^ $.1,

                             e ^ $. 6, e ^ $. 7, e ^ $. 8, e ^ $. 9,
                             e ^ $.14, e ^ $.15, e ^ $.16, e ^ $.17,

                             f ^ $.22, f ^ $.23, f ^ $.24, f ^ $.25,
                             f ^ $.30, f ^ $.31, f ^ $.32, f ^ $.33]

                        :  [ #.0 + #.1, gi ^ a, gi ^ b,

                             e ^ $. 2, e ^ $. 3, e ^ $. 4, e ^ $. 5,
                             e ^ $.10, e ^ $.11, e ^ $.12, e ^ $.13,
                             f ^ $.18, f ^ $.19, f ^ $.20, f ^ $.21,
                             f ^ $.26, f ^ $.27, f ^ $.28, f ^ $.29,
                             #. 2 + #.10, #. 3 + #.11, #. 4 + #.12, #. 5 + #.13,
                             #. 6 + #.14, #. 7 + #.15, #. 8 + #.16, #. 9 + #.17]

                        :  [ #.0, #.0 + #.1, #.0 + #.2,
                             #. 3 + #.11, #. 4 + #.12, #. 5 + #.13, #. 6 + #.14,
                             #.19, #.20, #.21, #.22,
                             #. 7 + #.15, #. 8 + #.16, #. 9 + #.17, #.10 + #.18,
                             #.23, #.24, #.25, #.26,

                             #.19, #.20, #.21, #.22,
                             #.23, #.24, #.25, #.26];

phi [ Gx42 -> Hx27 ] = [$. 6 + $. 7 + $. 8 + $. 9,                  /* (~w,^w) */
                        $.14 + $.15 + $.16 + $.17]

                    :  [g ^ $. 0, h ^ $. 1, g ^ #. 0,gi ^ #. 1,

                        e ^ $. 2, e ^ $. 3, e ^ $. 4, e ^ $. 5,
                        e ^ $. 6, e ^ $. 7, e ^ $. 8, e ^ $. 9,
                        e ^ $.10, e ^ $.11, e ^ $.12, e ^ $.13,
                        e ^ $.14, e ^ $.15, e ^ $.16, e ^ $.17,

                        f ^ $.18, f ^ $.19, f ^ $.20, f ^ $.21,
                        f ^ $.22, f ^ $.23, f ^ $.24, f ^ $.25,
                        f ^ $.26, f ^ $.27, f ^ $.28, f ^ $.29,
                        f ^ $.30, f ^ $.31, f ^ $.32, f ^ $.33,

                        x. 3 ^ $. 2, x. 4 ^ $. 3, x. 5 ^ $. 4, x. 6 ^ $. 5,
                        x.11 ^ $.10, x.12 ^ $.11, x.13 ^ $.12, x.14 ^ $.13,

                        f ^ $.34, f ^ $.35, f ^ $.36, f ^ $.37,
                        f ^ $.38, f ^ $.39, f ^ $.40, f ^ $.41]
                     : [#.0 + #.1, #.2 + #.1, #.3 + #.1,

                        #. 4 + #.20, #. 5 + #.21, #. 6 + #.22, #. 7 + #.23,
                        #. 8 + #.24, #. 9 + #.25, #.10 + #.26, #.11 + #.27,
                        #.12 + #.28, #.13 + #.29, #.14 + #.30, #.15 + #.31,
                        #.16 + #.32, #.17 + #.33, #.18 + #.34, #.19 + #.35,

                        #.36 + #.44, #.37 + #.45, #.38 + #.46, #.39 + #.47,
                        #.40 + #.48, #.41 + #.49, #.42 + #.50, #.43 + #.51
                    ];

sigma = SigmaGsp[phi, x, w, 1234567, 160];
